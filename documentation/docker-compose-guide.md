# Docker Compose —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö Docker Compose —Ñ–∞–π–ª–æ–≤ –∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã](#–¥–æ—Å—Ç—É–ø–Ω—ã–µ-—Ñ–∞–π–ª—ã)
- [–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫](#—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π-–∑–∞–ø—É—Å–∫)
- [–ó–∞–ø—É—Å–∫ –±–µ–∑ CloudPub](#–∑–∞–ø—É—Å–∫-–±–µ–∑-cloudpub)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—Å–µ—Ä–≤–∏—Å–∞–º–∏)
- [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)

## üîç –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Docker Compose –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤. –î–æ—Å—Ç—É–ø–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π.

## üìÅ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `docker-compose.yml` (AMD64)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π AMD64 (x86_64).

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
docker compose -f docker-compose.yml up -d
```

**–í–∫–ª—é—á–∞–µ—Ç:**
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- CloudPub —Å–µ—Ä–≤–∏—Å—ã (–¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –æ–±–ª–∞–∫–æ)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** AMD64 (x86_64)

---

### 2. `docker-compose-arm64.yml` (ARM64)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π ARM64 (Raspberry Pi, Apple Silicon).

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
docker compose -f docker-compose-arm64.yml up -d
```

**–í–∫–ª—é—á–∞–µ—Ç:**
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- CloudPub —Å–µ—Ä–≤–∏—Å—ã —Å ARM64 –æ–±—Ä–∞–∑–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** ARM64

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `cloudpub/cloudpub:latest-arm64` –¥–ª—è CloudPub
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è Raspberry Pi –∏ Apple Silicon

---

### 3. `docker-compose-without-cloudpub.yml`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑ CloudPub —Å–µ—Ä–≤–∏—Å–æ–≤ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ –µ—Å–ª–∏ CloudPub –Ω–µ –Ω—É–∂–µ–Ω).

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
docker compose -f docker-compose-without-cloudpub.yml up -d
```

**–í–∫–ª—é—á–∞–µ—Ç:**
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
- –ë–µ–∑ CloudPub —Å–µ—Ä–≤–∏—Å–æ–≤

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞:**
- –ù–µ –Ω—É–∂–Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –≤ –æ–±–ª–∞–∫–æ
- –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ CloudPub)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

---

## üöÄ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:**
   ```bash
   cp .env.example .env
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - `MAX_BOT_TOKEN` - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - `POSTGRES_PASSWORD` - –ø–∞—Ä–æ–ª—å –ë–î (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
   - `CLOUDPUB_TOKEN` - —Ç–æ–∫–µ–Ω CloudPub (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

   –ü–æ–¥—Ä–æ–±–Ω–µ–µ: [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](environment-variables.md)

### –®–∞–≥ 2: –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞

**–î–ª—è ARM64 (Raspberry Pi, Apple Silicon):**
```bash
docker compose -f docker-compose-arm64.yml up -d
```

**–î–ª—è AMD64 (–æ–±—ã—á–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã):**
```bash
docker compose -f docker-compose.yml up -d
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs -f
```

### –®–∞–≥ 4: –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

- **Admin Panel:** http://localhost:8081
- **MAX API:** http://localhost:8003/docs
- **University API:** http://localhost:8001/docs
- **Ghost API:** http://localhost:8004/docs
- **Mini App:** http://localhost:8002

---

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# ARM64
docker compose -f docker-compose-arm64.yml up -d

# AMD64
docker compose -f docker-compose.yml up -d
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
docker compose -f docker-compose-arm64.yml down
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose -f docker-compose-arm64.yml restart api

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose -f docker-compose-arm64.yml restart
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker compose -f docker-compose-arm64.yml logs -f

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker compose -f docker-compose-arm64.yml logs -f api
docker compose -f docker-compose-arm64.yml logs -f bot
docker compose -f docker-compose-arm64.yml logs -f admin-panel
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤

```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –æ–±—Ä–∞–∑–æ–≤
docker compose -f docker-compose-arm64.yml build

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose -f docker-compose-arm64.yml build admin-panel

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker compose -f docker-compose-arm64.yml up -d --build
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ (—Å –¥–∞–Ω–Ω—ã–º–∏)

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker-compose-arm64.yml down

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞, —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ volumes (‚ö†Ô∏è —É–¥–∞–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –ë–î!)
docker compose -f docker-compose-arm64.yml down -v
```

---

## üì¶ –û–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

### postgres

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

**–ü–æ—Ä—Ç:** 5432

**Volumes:**
- `postgres_data` - –¥–∞–Ω–Ω—ã–µ –ë–î

**Healthcheck:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ë–î –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

---

### api (MAX API)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–æ–π API —Å–µ—Ä–≤–∏—Å.

**–ü–æ—Ä—Ç:** 8003 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `postgres` (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–¥–æ—Ä–æ–≤–∞)

**Volumes:**
- `./app:/app` - –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `DATABASE_URL` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- `MAX_API_HOST`, `MAX_API_PORT` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
- `MAX_API_DOMAIN_URL` - –¥–æ–º–µ–Ω–Ω—ã–π URL

---

### bot

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** MAX –±–æ—Ç.

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `api` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω)

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `MAX_BOT_TOKEN` - —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

**Restart:** `unless-stopped` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ—è—Ö.

---

### admin-panel

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–µ–±-–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å.

**–ü–æ—Ä—Ç:** 8081 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ 8080 –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `api` (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω)

**Volumes:**
- –ù–µ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π build)

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `ADMIN_PANEL_HOST`, `ADMIN_PANEL_PORT` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
- `ADMIN_PANEL_DOMAIN_URL` - –¥–æ–º–µ–Ω–Ω—ã–π URL
- `MAX_API_DOMAIN_URL`, `MAX_API_HOST`, `MAX_API_PORT` - –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Nginx –¥–ª—è —Ä–∞–∑–¥–∞—á–∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `config.js` –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ

---

### university-api

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∞–π—Ç–æ–º —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞.

**–ü–æ—Ä—Ç:** 8001 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `postgres` (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–¥–æ—Ä–æ–≤–∞)

**Volumes:**
- `./university-app:/app` - –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** `university_db` (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î)

---

### ghost-api

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∑–µ—Ä–≤–Ω—ã–π API –¥–ª—è —Ä—É—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ü–æ—Ä—Ç:** 8004 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `postgres` (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–¥–æ—Ä–æ–≤–∞)

**Volumes:**
- `./ghost-app:/app` - –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** `ghost_db` (–æ—Ç–¥–µ–ª—å–Ω–∞—è –ë–î)

---

### mini-app

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –±–æ—Ç–∞.

**–ü–æ—Ä—Ç:** 8002 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**Volumes:**
- –ù–µ –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π build)

---

### cloudpub-* (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–µ—Ä–≤–∏—Å—ã –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –æ–±–ª–∞–∫–æ —á–µ—Ä–µ–∑ CloudPub.

**–ß—Ç–æ —Ç–∞–∫–æ–µ CloudPub:**
CloudPub ‚Äî —ç—Ç–æ —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–π –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º, –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π ngrok. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç—É–Ω–Ω–µ–ª–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã.

**–ü–æ—á–µ–º—É CloudPub –≤–∞–∂–µ–Ω:**
1. **Mini App —Ç—Ä–µ–±—É–µ—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:** Mini App –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ MAX. CloudPub –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –¥–æ–º–µ–Ω `max-miniapp.cloudpub.ru`.
2. **–£–ø—Ä–æ—â–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ DNS, SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ —Ñ–∞–π—Ä–≤–æ–ª–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞.
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** –¢—É–Ω–Ω–µ–ª–∏ CloudPub –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–æ–º.
4. **–ì–∏–±–∫–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- `CLOUDPUB_TOKEN` –≤ `.env`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç `network_mode: host` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–∏—Å–∞–º
- –°–æ–∑–¥–∞—é—Ç —Ç—É–Ω–Ω–µ–ª–∏ –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º –ø–æ—Ä—Ç–∞–º
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤

**–°–µ—Ä–≤–∏—Å—ã:**
- `cloudpub-api` - —Ç—É–Ω–Ω–µ–ª—å –∫ MAX API (–ø–æ—Ä—Ç 8003)
- `cloudpub-admin-panel` - —Ç—É–Ω–Ω–µ–ª—å –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (–ø–æ—Ä—Ç 8081)
- `cloudpub-university-api` - —Ç—É–Ω–Ω–µ–ª—å –∫ University API (–ø–æ—Ä—Ç 8001)
- `cloudpub-mini-app` - —Ç—É–Ω–Ω–µ–ª—å –∫ Mini App (–ø–æ—Ä—Ç 8002) - **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã Mini App**
- `cloudpub-ghost-api` - —Ç—É–Ω–Ω–µ–ª—å –∫ Ghost API (–ø–æ—Ä—Ç 8004)

---

## üîÑ –ó–∞–ø—É—Å–∫ –±–µ–∑ CloudPub

–ï—Å–ª–∏ CloudPub –Ω–µ –Ω—É–∂–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose-without-cloudpub.yml`:

```bash
docker compose -f docker-compose-without-cloudpub.yml up -d
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ú–µ–Ω—å—à–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ú–µ–Ω—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- –ë—ã—Å—Ç—Ä–µ–µ –∑–∞–ø—É—Å–∫

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ù–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ –æ–±–ª–∞–∫–æ
- –ù—É–∂–µ–Ω –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä–∞–º

**‚ö†Ô∏è –í–∞–∂–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:**
- **Mini App –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –¥–æ–º–µ–Ω—É `max-miniapp.cloudpub.ru` —á–µ—Ä–µ–∑ CloudPub
- –î–ª—è —Ä–∞–±–æ—Ç—ã Mini App –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å CloudPub (`docker-compose.yml` –∏–ª–∏ `docker-compose-arm64.yml`)
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (API, Admin Panel, University API, Ghost API) –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã

**–û—à–∏–±–∫–∞:**
```
Error: bind: address already in use
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç—ã –≤ `.env`:
   ```env
   MAX_API_PORT=8004
   ADMIN_PANEL_PORT=8082
   ```

2. –ò–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∑–∞–Ω–∏–º–∞—é—â–µ–µ –ø–æ—Ä—Ç:
   ```bash
   # –ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É
   sudo lsof -i :8003
   
   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
   sudo kill -9 <PID>
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–û—à–∏–±–∫–∞:**
```
FATAL: database "maxbot_db" does not exist
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `DATABASE_URL` –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω:
   ```bash
   docker compose ps postgres
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker compose logs postgres
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ —Å–±–æ—Ä–∫–∏

**–û—à–∏–±–∫–∞:**
```
ERROR: failed to solve: process "/bin/sh -c ..." did not complete successfully
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à Docker:
   ```bash
   docker system prune -a
   ```

2. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑:
   ```bash
   docker compose -f docker-compose-arm64.yml build --no-cache admin-panel
   ```

3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ:
   ```bash
   df -h
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   docker compose logs -f <service-name>
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   docker compose ps
   ```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å:
   ```bash
   docker compose restart <service-name>
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–±–æ—Ä–∫–∞ Flutter

**–†–µ—à–µ–Ω–∏–µ:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ BuildKit:
   ```bash
   export DOCKER_BUILDKIT=1
   docker compose build admin-panel
   ```

2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏:
   ```bash
   cd admin-panel
   ./build.sh
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.dockerignore` - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å–∫–ª—é—á–µ–Ω—ã –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker compose ps

# –°—Ç–∞—Ç—É—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose ps api
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
docker stats

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
docker stats maxbot_api
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è

```bash
# Health check –¥–ª—è postgres
docker compose exec postgres pg_isready -U maxbot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
curl http://localhost:8003/health
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
   ```env
   POSTGRES_PASSWORD=very_secure_password
   ```

2. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ firewall
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ reverse proxy (Nginx, Traefik)

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS:**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ–º–µ–Ω–Ω—ã–µ URL —Å HTTPS

4. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –æ–±—Ä–∞–∑—ã:**
   ```bash
   docker compose pull
   docker compose up -d
   ```

---

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –û—á–∏—Å—Ç–∫–∞

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker image prune -a

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö volumes
docker volume prune

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (‚ö†Ô∏è —É–¥–∞–ª–∏—Ç –≤—Å–µ!)
docker system prune -a --volumes
```

### –ë—ç–∫–∞–ø –ë–î

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
docker compose exec postgres pg_dump -U maxbot maxbot_db > backup.sql

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
docker compose exec -T postgres psql -U maxbot maxbot_db < backup.sql
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞
docker compose config

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker compose config api
```


